{% extends 'base.html' %}

{% block content %}
    {# 1. Insertamos el Carrusel #}
    {% include 'components/hero_carrusel.html' %}

    <section class="home-grid">
        <div class="home-column">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; flex-wrap: wrap; gap: 10px;">
                
                <h2 style="margin: 0;">
                    {% if categoria_seleccionada %}
                        {{ categoria_seleccionada.nombre }}
                    {% else %}
                        Últimas Noticias
                    {% endif %}
                </h2>
                
                <form method="get" style="display: flex; align-items: center;">
                    <label for="orden" style="margin-right: 8px; font-size: 0.9rem; color: var(--footer-text); font-weight: 500;">
                        Ordenar por:
                    </label>
                    <select name="orden" id="orden" onchange="this.form.submit()" 
                            style="padding: 6px 10px; border-radius: 6px; border: 1px solid var(--border-color); background-color: var(--bg-color); color: var(--text-color); cursor: pointer; font-size: 0.9rem;">
                        <option value="reciente" {% if orden_actual == 'reciente' %}selected{% endif %}>Más recientes</option>
                        <option value="antigua" {% if orden_actual == 'antigua' %}selected{% endif %}>Más antiguas</option>
                        <option value="alpha_asc" {% if orden_actual == 'alpha_asc' %}selected{% endif %}>A - Z</option>
                        <option value="alpha_desc" {% if orden_actual == 'alpha_desc' %}selected{% endif %}>Z - A</option>
                    </select>
                </form>

            </div>

            <ul class="news-list">
                {# 2. Iteramos las noticias usando el componente Card #}
                {% for noticia in noticias %}
                    {% include 'components/card_articulo.html' with articulo=noticia %}
                {% empty %}
                    <div style="padding: 2rem; text-align: center; color: var(--footer-text); background: var(--news-thumb-bg); border-radius: 8px;">
                        <p>No se encontraron noticias con este filtro.</p>
                    </div>
                {% endfor %}
            </ul>
        </div>

        {# Barra lateral de categorías #}
        <aside class="home-column">
            <h2>Categorías Populares</h2>
            
            {% if categorias_populares %}
                <ul class="category-list">
                    {% for cat in categorias_populares %}
                        <li class="categoria-item-destacada">
                            <a href="{% url 'listar_por_categoria' cat.id %}">
                                <span class="categoria-nombre">{{ cat.nombre }}</span>
                                <span class="categoria-count">{{ cat.num_articulos }} artículo{{ cat.num_articulos|pluralize }}</span>
                            </a>
                        </li>
                    {% endfor %}
                </ul>
            {% else %}
                <p style="color: var(--footer-text); font-style: italic;">No hay categorías con artículos aún.</p>
            {% endif %}
        </aside>
    </section>
    
    <style>
        /* Estilos para categorías destacadas */
        .categoria-item-destacada {
            margin-bottom: 1rem;
        }
        
        .categoria-item-destacada a {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 10px;
            text-decoration: none;
            transition: all 0.3s ease;
        }
        
        .categoria-item-destacada a:hover {
            border-color: var(--header-bg);
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(16, 134, 0, 0.15);
        }
        
        .categoria-nombre {
            font-weight: 600;
            font-size: 1.05rem;
            color: var(--title-color);
        }
        
        .categoria-count {
            background: var(--header-bg);
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 50px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .categoria-item-destacada:nth-child(1) .categoria-count {
            background: #FFD700; /* Oro para la primera */
            color: #000;
        }
        
        .categoria-item-destacada:nth-child(2) .categoria-count {
            background: #C0C0C0; /* Plata para la segunda */
            color: #000;
        }
        
        .categoria-item-destacada:nth-child(3) .categoria-count {
            background: #CD7F32; /* Bronce para la tercera */
            color: #fff;
        }
    </style>
{% endblock %}